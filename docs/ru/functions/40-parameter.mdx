---
weight: 40
sourceSHA: 293a6fe21a1311d28614b3f51fa16a8ae941075084b34d65407aef46775bf93d
---

# Конфигурация параметров

При создании экземпляра Kafka по умолчанию используется шаблон системных параметров. Вы также можете настроить конфигурацию в пределах шаблона параметров.

<Directive type="tip" title="Примечания">
  1. После обновления версии Kafka, если есть параметры, которые необходимо удалить, отсоединить или изменить, пожалуйста, обратитесь к соответствующим изменениям на <a href="https://kafka.apache.org/documentation" target="_blank">официальном сайте Kafka</a>.
  2. Для обеспечения стабильной работы среды Kafka определенные параметры и префиксы параметров не поддерживаются для конфигурации (например, `advertised.`
     `authorizer.`
     `broker.`
     `controller`
     `cruise.control.metrics.reporter.bootstrap.`
     `cruise.control.metrics.topic`
     `host.name`
     `inter.broker.listener.name`
     `listener.`
     `listeners.`
     `log.dir`
     `password.`
     `port`
     `process.roles`
     `sasl.`
     `security.`
     `servers,node.id`
     `ssl.`
     `super.user`
     `zookeeper.clientCnxnSocket`
     `zookeeper.connect`
     `zookeeper.set.acl`
     `zookeeper.ssl`).
</Directive>

## Процедура

<Tabs>
  <Tab label="CLI">
    ```bash
    # Обновить конфигурацию экземпляра
    kubectl -n <namespace> patch rdskafka <name> --type=merge --patch='{"spec": {"config": {"auto.create.topics.enable":"true"}}}'
    ```
  </Tab>

  <Tab label="Веб-консоль">
    1. Нажмите на **Kafka** в левой боковой панели.
    2. Выберите целевое пространство имен.
    3. Нажмите на имя целевого экземпляра, чтобы войти на страницу деталей.
    4. На вкладке **Конфигурация параметров** нажмите **Обновить параметры**.
    5. Установите параметры в соответствии с потребностями бизнеса.
    6. Нажмите **Обновить**.
  </Tab>
</Tabs>

## Описание поддержки параметров \{#parameter-support-description}

| Параметр                                     | типология | описания                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | значение по умолчанию | выборочное значение |
| --------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------- | ------------------- |
| auto.create.topics.enable                     | boolean  | Включить автоматическое создание темы на сервере                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | true                  |                     |
| auto.leader.rebalance.enable                  | boolean  | Включает автоматическое перераспределение лидеров. Фоновый поток периодически проверяет распределение лидеров разделов на регулярных интервалах, настраиваемых с помощью `leader.imbalance.check.interval.seconds`. Если дисбаланс лидера превышает `leader.imbalance.per.broker.percentage`, произойдет перераспределение лидера на предпочтительного лидера для разделов.                                                                                                                                                                                                                                                                                                                                                  | true                  |                     |
| background.threads                            | int      | Количество потоков, используемых для различных фонових задач                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 10                    | \[1,...]            |
| compression.type                              | string   | Укажите окончательный тип сжатия для данной темы. Эта конфигурация принимает стандартные кодеки сжатия ('gzip', 'snappy', 'lz4', 'zstd'). Также принимается 'uncompressed', что эквивалентно отсутствию сжатия; и 'producer', что означает сохранение оригинального кодека сжатия, установленного производителем.                                                                                                                                                                                                                                                                                                                                                           | producer              |                     |
| delete.topic.enable                           | boolean  | Включает удаление темы. Удаление темы через инструмент администратора не будет иметь эффекта, если эта настройка отключена                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | true                  |                     |
| leader.imbalance.check.interval.seconds       | long     | Частота проверки перераспределения разделов, инициируемая контроллером                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 300                   |                     |
| leader.imbalance.per.broker.percentage        | int      | Допустимое соотношение дисбаланса лидера на брокера. Контроллер вызовет перераспределение лидера, если это значение превысит заданное значение для брокера. Значение указывается в процентах.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 10                    |                     |
| log.flush.interval.messages                   | long     | Количество сообщений, накопленных на разделе журнала, прежде чем сообщения будут сброшены на диск                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 9223372036854775807   | \[1,...]            |
| log.flush.offset.checkpoint.interval.ms       | int      | Частота обновления постоянной записи последнего сброса, которая служит точкой восстановления журнала                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 60000                 | \[0,...]            |
| log.flush.scheduler.interval.ms               | long     | Частота в мс, с которой очистка журнала проверяет, нужно ли сбрасывать какой-либо журнал на диск                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 9223372036854775807   |                     |
| log.flush.start.offset.checkpoint.interval.ms | int      | Частота обновления постоянной записи начального смещения журнала                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 60000                 | \[0,...]            |
| log.retention.bytes                           | long     | Максимальный размер журнала перед его удалением                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | -1                    |                     |
| log.retention.hours                           | int      | Количество часов, в течение которых журнал будет храниться перед его удалением (в часах), третичный к свойству log.retention.ms                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 168                   |                     |
| log.roll.hours                                | int      | Максимальное время, прежде чем новый сегмент журнала будет развернут (в часах), вторичный к свойству log.roll.ms                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 168                   | \[1,...]            |
| log.roll.jitter.hours                         | int      | Максимальное дрожание, которое следует вычесть из logRollTimeMillis (в часах), вторичный к свойству log.roll.jitter.ms                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 0                     | \[0,...]            |
| log.segment.bytes                             | int      | Максимальный размер одного файла журнала                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 1073741824            | \[14,...]           |
| log.segment.delete.delay.ms                   | long     | Время ожидания перед удалением файла из файловой системы                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 60000                 | \[0,...]            |
| message.max.bytes                             | int      | Максимальный размер пакета записей, разрешенный Kafka (после сжатия, если сжатие включено). Если это значение увеличивается и есть потребители старше 0.10.2, размер выборки потребителей также должен быть увеличен, чтобы они могли взять пакеты записей такого размера. В последней версии формата сообщения записи всегда группируются в пакеты для повышения эффективности. В предыдущих версиях формата сообщений несжатые записи не группируются в пакеты, и это ограничение применяется только к одной записи в этом случае. Это значение можно установить для каждой темы с помощью конфигурации max.message.bytes на уровне темы.                                                                                    | 1048588               | \[0,...]            |
| min.insync.replicas                           | int      | Когда производитель устанавливает acks на "все" (или "-1"), min.insync.replicas указывает минимальное количество реплик, которые должны подтвердить запись, чтобы запись считалась успешной. Если это минимальное значение не может быть выполнено, то производитель выдаст исключение (либо NotEnoughReplicas, либо NotEnoughReplicasAfterAppend). При совместном использовании min.insync.replicas и acks вы можете обеспечить большие гарантии долговечности. Типичный сценарий может заключаться в том, чтобы создать тему с фактором репликации 3, установить min.insync.replicas на 2 и произвести с acks "все". Это гарантирует, что производитель выдаст исключение, если большинство реплик не получат запись. | 1                     | \[1,...]            |
| num.io.threads                                | int      | Количество потоков, которые сервер использует для обработки запросов, что может включать операции ввода-вывода на диске                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 8                     | \[1,...]            |
| num.network.threads                           | int      | Количество потоков, которые сервер использует для получения запросов из сети и отправки ответов в сеть                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 3                     | \[1,...]            |
| num.recovery.threads.per.data.dir             | int      | Количество потоков на директорию данных, используемое для восстановления журнала при запуске и сбросе во время завершения работы                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1                     | \[1,...]            |
| num.replica.fetchers                          | int      | Количество потоков выборки, используемых для репликации сообщений из исходного брокера. Увеличение этого значения может увеличить степень параллелизма ввода-вывода на подчиненном брокере.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 1                     |                     |
| offset.metadata.max.bytes                     | int      | Максимальный размер для записи метаданных, связанной с фиксацией смещения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 4096                  |                     |
| offsets.commit.required.acks                  | short    | Необходимые acks, прежде чем фиксация может быть принята. В общем, значение по умолчанию (-1) не следует переопределять                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | -1                    |                     |
| offsets.commit.timeout.ms                     | int      | Фиксация смещения будет задержана, пока все реплики для темы смещений не получат фиксацию или данное время ожидания не истечет. Это аналогично времени ожидания запроса производителя.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 5000                  | \[1,...]            |
| offsets.load.buffer.size                      | int      | Размер пакета для чтения из сегментов смещений при загрузке смещений в кэш (мягкий лимит, переопределяется, если записи слишком велики).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 5242880               | \[1,...]            |
| offsets.retention.check.interval.ms           | long     | Частота, с которой проверяются устаревшие смещения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 600000                | \[1,...]            |
| offsets.retention.minutes                     | int      | После того как группа потребителей потеряет всех своих потребителей (т.е. станет пустой), ее смещения будут храниться в течение этого периода удержания перед тем, как их выбросят. Для независимых потребителей (использующих ручное назначение) смещения будут истекать после времени последней фиксации плюс этот период удержания.                                                                                                                                                                                                                                                                                                                                                                                            | 10080                 | \[1,...]            |
| offsets.topic.compression.codec               | int      | Кодек сжатия для темы смещений - сжатие может быть использовано для достижения "атомарных" фиксаций                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 0                     |                     |
| offsets.topic.num.partitions                  | int      | Количество разделов для темы фиксации смещений (не должно изменяться после развертывания)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 50                    | \[1,...]            |
| offsets.topic.replication.factor              | short    | Фактор репликации для темы смещений (установите выше, чтобы обеспечить доступность). Создание внутренней темы потерпит неудачу, пока размер кластера не соответствует этому требованию фактора репликации.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 3                     | \[1,...]            |
| offsets.topic.segment.bytes                   | int      | Сегментные байты темы смещений должны быть относительно небольшими, чтобы облегчить более быстрое сжатие журнала и загрузку кэша                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 104857600             | \[1,...]            |
| queued.max.requests                           | int      | Максимальное количество ожидающих запросов, разрешенных для канала данных, прежде чем заблокировать сетевые потоки                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 500                   | \[1,...]            |
| quota.consumer.default                        | long     | УСТАРЕЛО: Используется только тогда, когда динамические квоты по умолчанию не настроены для или в Zookeeper. Любой потребитель, отличающийся по clientId/группе потребителей, будет ограничен, если он будет получать больше байт, чем это значение в секунду                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 9223372036854775807   | \[1,...]            |
| quota.producer.default                        | long     | УСТАРЕЛО: Используется только тогда, когда динамические квоты по умолчанию не настроены для или в Zookeeper. Любой производитель, отличающийся по clientId, будет ограничен, если он будет производить больше байт, чем это значение в секунду                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 9223372036854775807   | \[1,...]            |
| replica.fetch.min.bytes                       | int      | Минимальное количество байт, ожидаемых для каждого ответа выборки. Если байт недостаточно, дождитесь максимального времени ожидания выбора                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 1                     |                     |
| replica.fetch.wait.max.ms                     | int      | максимальное время ожидания для каждого запроса выборки, выданного подчиненными репликами. Это значение всегда должно быть меньше replica.lag.time.max.ms, чтобы предотвратить частое сокращение ISR для тем с низкой пропускной способностью                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | 500                   |                     |
| replica.high.watermark.checkpoint.interval.ms | long     | Частота, с которой высокое воздействие сохраняется на диск                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 5000                  |                     |
| replica.lag.time.max.ms                       | long     | Если подчиненный не отправил никаких запросов выборки или не потреблял до конца журнала лидера хотя бы это время, лидер удалит подчиненного из isr                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 30000                 |                     |
| replica.socket.receive.buffer.bytes           | int      | Буфер приема сокета для сетевых запросов                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 65536                 |                     |
| replica.socket.timeout.ms                     | int      | Тайм-аут сокета для сетевых запросов. Его значение должно быть не менее replica.fetch.wait.max.ms                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 30000                 |                     |
| request.timeout.ms                            | int      | Конфигурация управляет максимальным временем, в течение которого клиент будет ожидать ответа на запрос. Если ответ не будет получен до истечения времени ожидания, клиент повторно отправит запрос, если это необходимо, или завершит запрос, если исчерпаны попытки.                                                                                                                                                                                                                                                                                                                                                                                                                | 30000                 |                     |
| socket.receive.buffer.bytes                   | int      | Буфер SO\_RCVBUF серверных сокетов. Если значение равно -1, будет использоваться значение по умолчанию ОС.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 102400                |                     |
| socket.request.max.bytes                      | int      | Максимальное количество байт в запросе сокета                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | 104857600             | \[1,...]            |
| socket.send.buffer.bytes                      | int      | Буфер SO\_SNDBUF серверных сокетов. Если значение равно -1, будет использоваться значение по умолчанию ОС.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 102400                |                     |
| transaction.max.timeout.ms                    | int      | Максимально допустимый тайм-аут для транзакций. Если запрашиваемое клиентом время транзакции превышает это значение, брокер вернет ошибку в InitProducerIdRequest. Это предотвращает слишком большой тайм-аут клиента, который может задержать потребителей, читающих из тем, включенных в транзакцию.                                                                                                                                                                                                                                                                                                                                                                                 | 900000                | \[1,...]            |
| transaction.state.log.load.buffer.size        | int      | Размер пакета для чтения из сегментов журнала транзакций при загрузке идентификаторов производителей и транзакций в кэш (мягкий лимит, переопределяется, если записи слишком велики).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 5242880               | \[1,...]            |
| transaction.state.log.min.isr                 | int      | Переопределенная конфигурация min.insync.replicas для темы транзакций.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 2                     | \[1,...]            |
| transaction.state.log.num.partitions          | int      | Количество разделов для темы транзакций (не должно изменяться после развертывания).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 50                    | \[1,...]            |
| transaction.state.log.replication.factor      | short    | Фактор репликации для темы транзакций (установите выше, чтобы обеспечить доступность). Создание внутренней темы потерпит неудачу, пока размер кластера не соответствует этому требованию фактора репликации.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 3                     | \[1,...]            |
| transaction.state.log.segment.bytes           | int      | Сегментные байты темы транзакций должны быть относительно небольшими, чтобы облегчить более быстрое сжатие журнала и загрузку кэша                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 104857600             | \[1,...]            |
| transactional.id.expiration.ms                | int      | Время в мс, на которое координатор транзакции будет ждать, не получая никаких обновлений статуса транзакции для текущей транзакции, прежде чем аннулировать свой идентификатор транзакции. Эта настройка также влияет на истечение срока действия идентификатора производителя - идентификаторы производителей истекают, как только это время истекает после последней записи с данным идентификатором производителя. Обратите внимание, что идентификаторы производителей могут истечь раньше, если последняя запись из идентификатора производителя удаляется в результате настроек удержания темы.                                                                                                                                                                                                         | 604800000             | \[1,...]            |
| unclean.leader.election.enable                | boolean  | Указывает, нужно ли разрешить выбор лидеров для реплик, не находящихся в наборе ISR, как последнее средство, даже если это может привести к потере данных                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | false                 |                     |
| zookeeper.max.in.flight.requests              | int      | Максимальное количество неподтвержденных запросов, которые клиент отправит Zookeeper, прежде чем заблокировать.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | 10                    | \[1,...]            |
| zookeeper.session.timeout.ms                  | int      | Тайм-аут сессии Zookeeper                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 18000                 |                     |

Для получения дополнительной информации о параметрах перейдите на [сайт Kafka](https://kafka.apache.org/documentation/#configuration).
